---
name: architecture of frontend
glob:
alwaysApply: true
---

# Frontend Architecture

## Hybrid Architecture: Blade + Vue.js

### Общая концепция

-   **Blade** - для статических страниц и серверного рендеринга
-   **Vue.js** - для интерактивных компонентов и SPA-функциональности
-   **Hybrid подход** - комбинирование серверного и клиентского рендеринга

## Blade Views Architecture

### Структура папок

-   `resources/views/components` — переиспользуемые Blade компоненты (layouts, navigation, footer)
-   `resources/views/pages` — страницы приложения (включая `pages/client`)
-   `resources/views/auth` — шаблоны аутентификации
-   `resources/views/livewire` — Livewire компоненты
-   `resources/views/vendor` — вендорные шаблоны

### Правила Blade компонентов

#### Layouts

-   **Основной макет**: `components/layouts/app.blade.php`
-   **Структура**: DOCTYPE + head + body с навигацией и футером
-   **Vite интеграция**: `@vite(['resources/css/app.css', 'resources/js/app.js'])`
-   **Стеки**: `@stack('styles')`, `@stack('scripts')`
-   **CSRF токен**: обязательный в head

#### Компоненты

-   **Именование**: kebab-case для файлов (`main.blade.php`)
-   **Использование**: `<x-component.name />`
-   **Props**: через атрибуты компонента
-   **Slots**: `{{ $slot }}` для контента

#### Страницы

-   **Структура**: наследование от основного макета
-   **Именование**: kebab-case для файлов
-   **Title**: через props макета `title="Page Title"`
-   **Контент**: в `<x-layouts.app>` wrapper

### Правила Blade разработки

1. **Компонентный подход**: разбивать UI на переиспользуемые компоненты
2. **Макеты**: использовать единый макет для всех страниц
3. **Навигация**: выносить в отдельные компоненты
4. **Стили**: Tailwind CSS классы, избегать inline стилей
5. **Скрипты**: через Vite, избегать inline JavaScript

## Vue.js Architecture

### Структура папок

-   `resources/js/components` — Vue компоненты, подкаталоги по доменам
-   `resources/js/stores` — Pinia stores (одно хранилище на домен)
-   `resources/js/dto` — Data Transfer Objects (request/response)
-   `resources/js/services` — сервисы и утилиты
-   `resources/js/app.js` — точка входа, авторегистрация компонентов, DI
-   `resources/js/bootstrap.js` — настройка axios, глобальные конфиги

### Правила Vue компонентов

#### Структура компонента

-   Импорты (внешние библиотеки, stores, DTO)
-   Экспорт с `name`
-   `data`, `computed`, `methods`
-   Шаблон с разметкой
-   Стили с `scoped`

#### Именование

-   **Файлы**: PascalCase (`LoginForm.vue`)
-   **Компоненты**: PascalCase в template
-   **Props**: camelCase
-   **Events**: kebab-case

#### Композиция

-   **Single File Components**: один файл = один компонент
-   **Scoped стили**: всегда использовать `scoped`
-   **Props validation**: через yup или встроенную валидацию
-   **Events**: четкое именование и документация

### Pinia Stores Architecture

#### Структура store

-   `state` — данные, токены, флаги загрузки, ошибки
-   `getters` — вычисляемые свойства и интерфейсы доступа
-   `actions` — асинхронные операции и интеграция с API

#### Правила stores

-   **Именование**: `use{Domain}Store`
-   **API вызовы**: только в stores, не в компонентах
-   **DTO**: обязательное формирование payload через DTO
-   **HMR поддержка**: обязательная для dev режима
-   **Типизация**: четкие типы для state
-   **Actions**: асинхронные операции
-   **Getters**: вычисляемые свойства
-   **Возвраты**: из actions возвращать `{ success, data | error }`
-   **Состояния**: централизованные `isLoading` и `error`

### Services Architecture

#### Структура сервиса

-   Чистые функции/методы, без зависимостей от UI
-   Именование: camelCase с суффиксом `Service`
-   Инъекция через provide/inject по необходимости

#### Правила сервисов

-   **Именование**: camelCase с суффиксом Service
-   **Инкапсуляция**: логика, не связанная с компонентами
-   **Dependency Injection**: через provide/inject
-   **Чистые функции**: без побочных эффектов

## Integration Patterns

### Blade + Vue Integration

#### Встраивание Vue в Blade

#### Правила интеграции

-   **Vue компоненты**: только для интерактивности
-   **Blade**: для статического контента и SEO
-   **Монтирование**: на элемент с id="app"
-   **Авторегистрация**: через import.meta.glob
-   **Vite**: подключение в макете, единая точка входа

### Routing Strategy

-   **Все страницы**: через Laravel routes (Blade)
-   **SEO оптимизация**: серверный рендеринг
-   **Мета-теги**: через Blade макеты
-   **Навигация**: стандартные ссылки Laravel

## Development Rules

### 1. Создание компонентов

#### Vue компонент

1. Файл в `resources/js/components/` (PascalCase)
2. Импорт stores и DTO
3. Разделение `form` (данные) и `schema` (валидация)
4. Scoped стили, Tailwind классы
5. API вызовы только через stores

#### Store

1. Файл в `resources/js/stores/` (`use{Domain}Store`)
2. State: данные, loading, error
3. Actions: API вызовы с DTO
4. Возврат `{ success, data/error }`

#### DTO

1. Файл в `resources/js/dto/domain/`
2. Функция-фабрика с default values
3. Именование: `{action}RequestDto`

### 2. State Management

**Использовать Pinia для:**

-   Глобального состояния (auth, settings)
-   API данных (orders, users)
-   Сложной логики (cart, filters)

**НЕ использовать Pinia для:**

-   Локального состояния форм
-   UI состояний (modal open/close)
-   Временных данных

### 3. Styling

-   **Tailwind**: utility-first, mobile-first
-   **Vue**: всегда scoped стили
-   **Глобальные**: только в app.css

## API & Данные

-   **Axios**: конфигурация в bootstrap.js, CSRF автоматически
-   **URL**: относительные пути `/api/`
-   **Ошибки**: обработка в stores, понятные сообщения в компонентах
-   **Кэширование**: через stores

## DTO (Data Transfer Objects)

-   **Обязательно**: для всех запросов/ответов
-   **Именование**: `{action}RequestDto`
-   **Фабрики**: функции с default values
-   **Запрет**: формирование payload в компонентах

## Form Handling & Validation

-   **Разделение**: `form` (данные) + `schema` (валидация)
-   **Yup**: валидация с русскими сообщениями
-   **Ошибки**: под полями + общий блок
-   **Состояния**: loading/error из store
-   **Сабмит**: валидация → store action → обработка результата

## Anti-Patterns (НЕ ДЕЛАТЬ)

❌ **API вызовы в компонентах** — только в stores
❌ **Смешивание form и schema** — разделять данные и валидацию
❌ **Inline стили** — использовать Tailwind классы
❌ **Прямые DOM манипуляции** в Vue
❌ **Дублирование состояния** между Blade и Vue
❌ **jQuery с Vue** — несовместимо
❌ **Монолитные компоненты** — декомпозиция обязательна
❌ **Отсутствие loading/error** состояний
❌ **Хардкод строк** — локализация
❌ **Игнорирование accessibility** (focus, aria)
