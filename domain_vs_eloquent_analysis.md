# üîç –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π: –î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å vs Eloquent –º–æ–¥–µ–ª—å

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∏–µ —Ä–∞–∑–ª–∏—á–∏—è](#–æ–±—â–∏–µ-—Ä–∞–∑–ª–∏—á–∏—è)
2. [–ß—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç –¥–æ–º–µ–Ω–∞](#—á—Ç–æ-—Å–∫—Ä—ã—Ç–æ-–æ—Ç-–¥–æ–º–µ–Ω–∞)
3. [–ü—Ä–∏—á–∏–Ω—ã —Å–∫—Ä—ã—Ç–∏—è](#–ø—Ä–∏—á–∏–Ω—ã-—Å–∫—Ä—ã—Ç–∏—è)
4. [–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π](#–ø—Ä–∏–º–µ—Ä—ã-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π)
5. [–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞](#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-—Ç–∞–∫–æ–≥–æ-–ø–æ–¥—Ö–æ–¥–∞)

---

## üéØ –û–±—â–∏–µ —Ä–∞–∑–ª–∏—á–∏—è

### **–î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (User.php)**

-   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞
-   **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –¢–æ–ª—å–∫–æ –æ—Ç –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
-   **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –ø–æ–ª—è —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –≥–µ—Ç—Ç–µ—Ä–∞–º–∏
-   **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏ –º–µ—Ç–æ–¥—ã
-   **–ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å**: Value Objects –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å

### **Eloquent –º–æ–¥–µ–ª—å (UserModel.php)**

-   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
-   **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: Laravel, Eloquent, Spatie Permission
-   **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü—É–±–ª–∏—á–Ω—ã–µ –ø–æ–ª—è —Å Laravel –º–∞–≥–∏–µ–π
-   **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ß–µ—Ä–µ–∑ Laravel –≤–∞–ª–∏–¥–∞—Ü–∏—é
-   **–ú—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ª—é–±—ã–µ –ø–æ–ª—è

---

## üö´ –ß—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç –¥–æ–º–µ–Ω–∞

### **1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ Laravel**

#### **Eloquent Traits –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
use HasApiTokens, HasFactory, HasRoles;

// –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç:
// - HasApiTokens: API —Ç–æ–∫–µ–Ω—ã, Sanctum
// - HasFactory: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
// - HasRoles: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ —á–µ—Ä–µ–∑ Spatie
```

#### **Laravel –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
extends Authenticatable
protected $guard_name = 'manager';

// –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç:
// - –ú–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (attempt, login, logout)
// - Guard —Å–∏—Å—Ç–µ–º–∞ Laravel
// - Remember me —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
```

### **2. –î–µ—Ç–∞–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

#### **–ü–æ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
protected $fillable = [
    'uuid',
    'name',
    'email',
    'password',
    'is_deleted',
    'two_factor_secret',        // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_recovery_codes', // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_confirmed_at',   // ‚Üê –°–∫—Ä—ã—Ç–æ!
];

protected $hidden = [
    'password',
    'remember_token',           // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_secret',        // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_recovery_codes', // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_secret',        // ‚Üê –°–∫—Ä—ã—Ç–æ!
];
```

#### **Laravel –∫–∞—Å—Ç–∏–Ω–≥:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
protected $casts = [
    'email_verified_at' => 'datetime',      // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'two_factor_confirmed_at' => 'datetime', // ‚Üê –°–∫—Ä—ã—Ç–æ!
    'is_deleted' => 'boolean',
];
```

### **3. Laravel –º–∞–≥–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã**

#### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
$model->id;                    // ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π primary key
$model->created_at;            // ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ timestamps
$model->updated_at;            // ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ timestamps
$model->remember_token;        // ‚Üê Laravel –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```

#### **Eloquent –æ—Ç–Ω–æ—à–µ–Ω–∏—è:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
$model->posts();               // ‚Üê Eloquent –æ—Ç–Ω–æ—à–µ–Ω–∏—è
$model->comments();            // ‚Üê Eloquent –æ—Ç–Ω–æ—à–µ–Ω–∏—è
$model->profile();             // ‚Üê Eloquent –æ—Ç–Ω–æ—à–µ–Ω–∏—è
```

### **4. Spatie Permission —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**

#### **–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏:**

```php
// –í UserModel.php - –ù–ï –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥–æ–º–µ–Ω–µ
$model->assignRole('admin');           // ‚Üê Spatie –º–µ—Ç–æ–¥
$model->removeRole('user');            // ‚Üê Spatie –º–µ—Ç–æ–¥
$model->hasRole('admin');              // ‚Üê Spatie –º–µ—Ç–æ–¥
$model->hasPermission('users.create'); // ‚Üê Spatie –º–µ—Ç–æ–¥
$model->syncRoles(['admin', 'user']);  // ‚Üê Spatie –º–µ—Ç–æ–¥
```

---

## ü§î –ü—Ä–∏—á–∏–Ω—ã —Å–∫—Ä—ã—Ç–∏—è

### **1. –ü—Ä–∏–Ω—Ü–∏–ø –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**

#### **–î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞:**

-   ‚úÖ –°–æ–¥–µ—Ä–∂–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
-   ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
-   ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
-   ‚úÖ –ë—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

#### **–î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ù–ï –¥–æ–ª–∂–Ω–∞:**

-   ‚ùå –ó–Ω–∞—Ç—å –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
-   ‚ùå –ó–∞–≤–∏—Å–µ—Ç—å –æ—Ç Laravel
-   ‚ùå –°–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
-   ‚ùå –£–ø—Ä–∞–≤–ª—è—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### **2. –ò–Ω–≤–µ—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

```
‚ùå –ü–õ–û–•–û: –î–æ–º–µ–Ω –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Laravel
Domain ‚Üí Laravel ‚Üí Database

‚úÖ –•–û–†–û–®–û: Laravel –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–æ–º–µ–Ω–∞
Laravel ‚Üí Domain ‚Üê Database
```

### **3. –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**

#### **–° Laravel –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:**

```php
// –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class User {
    public function someMethod() {
        // –ó–∞–≤–∏—Å–∏—Ç –æ—Ç Laravel Auth, Database, etc.
        if (Auth::check()) { ... }
        if (DB::table('users')->exists()) { ... }
    }
}
```

#### **–ë–µ–∑ Laravel –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**

```php
// –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class User {
    public function someMethod() {
        // –¢–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
        if ($this->isActive && !$this->isDeleted) { ... }
    }
}
```

### **4. –ó–∞–º–µ–Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**

#### **–ï—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å Laravel:**

-   ‚úÖ –î–æ–º–µ–Ω –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
-   ‚úÖ –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–æ–ª—å–∫–æ Infrastructure —Å–ª–æ–π
-   ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è

#### **–ï—Å–ª–∏ –¥–æ–º–µ–Ω –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Laravel:**

-   ‚ùå –ü—Ä–∏–¥—ë—Ç—Å—è –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –≤–µ—Å—å –¥–æ–º–µ–Ω
-   ‚ùå –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Å–ª–æ–º–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
-   ‚ùå –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏

---

## üîÑ –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π

### **1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ Eloquent –≤ –¥–æ–º–µ–Ω**

```php
// UserMapper::toDomain()
public static function toDomain(UserModel $model): DomainUser
{
    return DomainUser::reconstitute(
        UserId::fromString($model->uuid ?? ''),           // string ‚Üí UserId
        $model->name,                                     // string ‚Üí string
        Email::fromString($model->email),                 // string ‚Üí Email
        PasswordHash::fromHash($model->password),         // string ‚Üí PasswordHash
        !$model->is_deleted,                              // bool ‚Üí bool (–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω)
        (bool) $model->is_deleted,                        // mixed ‚Üí bool
        $model->getRoleNames()->toArray()                 // Collection ‚Üí array
    );
}
```

#### **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **UUID**: `string` ‚Üí `UserId` (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
2. **Email**: `string` ‚Üí `Email` (—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
3. **Password**: `string` ‚Üí `PasswordHash` (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∞)
4. **is_deleted**: `mixed` ‚Üí `bool` (—Å –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤)
5. **isActive**: –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è (`!$model->is_deleted`)
6. **Roles**: `Collection` ‚Üí `array` (—Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –∏–º—ë–Ω —Ä–æ–ª–µ–π)

### **2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –¥–æ–º–µ–Ω–∞ –≤ Eloquent**

```php
// UserMapper::toModel()
public static function toModel(DomainUser $domain, ?UserModel $model = null): UserModel
{
    $model = $model ?? new UserModel();
    $model->uuid = (string) $domain->userId();           // UserId ‚Üí string
    $model->name = $domain->name();                       // string ‚Üí string
    $model->email = (string) $domain->email();            // Email ‚Üí string
    $model->password = (string) $domain->passwordHash();  // PasswordHash ‚Üí string
    $model->is_deleted = $domain->isDeleted();            // bool ‚Üí bool
    return $model;
}
```

#### **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **UserId**: `UserId` ‚Üí `string` (—á–µ—Ä–µ–∑ `__toString()`)
2. **Email**: `Email` ‚Üí `string` (—á–µ—Ä–µ–∑ `__toString()`)
3. **PasswordHash**: `PasswordHash` ‚Üí `string` (—á–µ—Ä–µ–∑ `__toString()`)
4. **–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è**: –ü—Ä—è–º–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### **3. –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è**

```php
// –≠—Ç–∏ –ø–æ–ª—è –ù–ï –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –¥–æ–º–µ–Ω:
$model->two_factor_secret;        // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->two_factor_recovery_codes; // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->two_factor_confirmed_at;   // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->remember_token;            // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->email_verified_at;        // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->created_at;                // ‚Üê –°–∫—Ä—ã—Ç–æ
$model->updated_at;                // ‚Üê –°–∫—Ä—ã—Ç–æ
```

---

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### **1. –ß–∏—Å—Ç–æ—Ç–∞ –¥–æ–º–µ–Ω–∞**

#### **–î–æ (—Å Laravel –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏):**

```php
class User {
    public function canEdit() {
        // –°–º–µ—à–∏–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
        return Auth::user()->hasRole('admin') ||
               $this->id === Auth::id() ||
               DB::table('permissions')->where('user_id', $this->id)->exists();
    }
}
```

#### **–ü–æ—Å–ª–µ (—á–∏—Å—Ç—ã–π –¥–æ–º–µ–Ω):**

```php
class User {
    public function canEdit(User $actor): bool {
        // –¢–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
        return $actor->hasRole('admin') ||
               $actor->userId()->equals($this->userId) ||
               $actor->hasPermission('users.edit');
    }
}
```

### **2. –õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

```php
// –¢–µ—Å—Ç –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
public function test_user_cannot_be_modified_when_deleted()
{
    $user = User::register($userId, "Test", $email, $passwordHash);
    $user->markDeleted();

    $this->expectException(InvalidArgumentException::class);
    $user->rename("New Name"); // –î–æ–ª–∂–Ω–æ –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
}
```

### **3. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞**

```php
// –î–æ–º–µ–Ω –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
$user = User::register($userId, "Test", $email, $passwordHash);

// Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
$user->save(); // –ß–µ—Ä–µ–∑ Repository

// CLI —Å–∫—Ä–∏–ø—Ç
$user->save(); // –ß–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π Repository

// API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
$user->save(); // –ß–µ—Ä–µ–∑ —Ç—Ä–µ—Ç–∏–π Repository
```

### **4. –Ø–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

```php
// –í–º–µ—Å—Ç–æ —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
class UserService {
    public function __construct(
        private UserRepositoryInterface $users,      // –Ø–≤–Ω–æ
        private PasswordHasherInterface $hasher,     // –Ø–≤–Ω–æ
        private RoleServiceInterface $roles,         // –Ø–≤–Ω–æ
        private EventBusInterface $events            // –Ø–≤–Ω–æ
    ) {}
}
```

---

## üö® –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤

### **1. –°–º–µ—à–∏–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**

```php
// ‚ùå –ü–õ–û–•–û: –î–æ–º–µ–Ω –∑–Ω–∞–µ—Ç –æ Laravel
class User {
    public function save() {
        // –î–æ–º–µ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö!
        DB::table('users')->insert([
            'uuid' => $this->userId,
            'name' => $this->name,
            // ...
        ]);
    }
}
```

### **2. –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

```php
// ‚ùå –ü–õ–û–•–û: –ù—É–∂–Ω–æ –º–æ–∫–∞—Ç—å Laravel
class UserTest {
    public function test_save_user() {
        // –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –º–æ–∫–∞—Ç—å DB —Ñ–∞—Å–∞–¥
        DB::shouldReceive('table')->once()->andReturnSelf();
        DB::shouldReceive('insert')->once();

        $user = new User();
        $user->save(); // –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
    }
}
```

### **3. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞**

```php
// ‚ùå –ü–õ–û–•–û: –ü—Ä–∏ –∑–∞–º–µ–Ω–µ Laravel –≤—Å—ë —Å–ª–æ–º–∞–µ—Ç—Å—è
class User {
    public function getFullName() {
        // –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç Laravel Config
        $format = config('app.name_format');
        return sprintf($format, $this->firstName, $this->lastName);
    }
}
```

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### **1. –î–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "–≥–ª—É–ø—ã–º"**

-   –°–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
-   –ù–µ –∑–Ω–∞—Ç—å –æ –≤–Ω–µ—à–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö
-   –ë—ã—Ç—å –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–º

### **2. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å "—É–º–Ω–æ–π"**

-   –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∫ –¥–æ–º–µ–Ω—É
-   –°–∫—Ä—ã–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
-   –û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### **3. –ú–∞–ø–ø–µ—Ä - —ç—Ç–æ –º–æ—Å—Ç**

-   –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
-   –°–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
-   –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–∏—Å—Ç–æ—Ç—É –¥–æ–º–µ–Ω–∞

### **4. –ü—Ä–∏–Ω—Ü–∏–ø "Tell, Don't Ask"**

-   –î–æ–º–µ–Ω –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å
-   –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å
-   –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

---

## üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π:**

-   ‚úÖ –î—É–º–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –æ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞—Ö
-   ‚úÖ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Laravel —Ñ–∞—Å–∞–¥—ã
-   ‚úÖ –ù–µ —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é
-   ‚úÖ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ Value Objects –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### **2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–∞–ø–ø–µ—Ä–æ–≤:**

-   ‚úÖ –°–∫—Ä—ã–≤–∞–π—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
-   ‚úÖ –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
-   ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏
-   ‚úÖ –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ª–∏—à–Ω–∏–µ –ø–æ–ª—è

### **3. –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:**

-   ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç Laravel
-   ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
-   ‚úÖ –§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ
-   ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

---

_–≠—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –ø–æ—á–µ–º—É –≤–∞–∂–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –¥–æ–º–µ–Ω –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∏ –∫–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞._ üéâ
