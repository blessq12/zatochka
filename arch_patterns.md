# Архитектурные паттерны

## Базовые архитектурные паттерны

### Паттерн: Layered Architecture (Многослойная архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте большой торговый центр, где все магазины, склады, офисы и технические помещения перемешаны. Покупателям пришлось бы проходить через склады, а грузчики мешали бы посетителям. Это создало бы хаос и неудобства для всех.
-   **В мире IT**: Необходимость организовать сложную систему так, чтобы разные её части (интерфейс, бизнес-логика, работа с данными) не смешивались и могли развиваться независимо друг от друга.

**Решение:**

-   **В повседневной жизни**: Разделение торгового центра на чёткие уровни: первый этаж для магазинов, второй для развлечений, подвал для складов, верхние этажи для офисов. Каждый уровень имеет своё назначение и правила взаимодействия с другими уровнями.
-   **В мире IT**: Разделение приложения на отдельные слои (уровни), где каждый слой отвечает за определённую функциональность и может общаться только с соседними слоями. Как правило, выделяют слои представления, бизнес-логики и данных.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Организация торгового центра по этажам
    -   Структура крупной компании (руководство → менеджеры → исполнители)
    -   Система образования (начальная → средняя → высшая школа)
    -   Организация книги (оглавление → главы → параграфы)
    -   Уровни управления в государстве (федеральный → региональный → муниципальный)
-   **В мире IT**:
    -   Классическое веб-приложение (UI → бизнес-логика → база данных)
    -   Операционная система (пользовательский интерфейс → системные сервисы → ядро)
    -   Сетевой стек протоколов (приложение → транспорт → сеть → канал)
    -   Корпоративные приложения с разделением на уровни доступа
    -   Мобильные приложения с разделением UI и логики

### Паттерн: Client-Server (Клиент-сервер)

**Проблемы:**

-   **В повседневной жизни**: Представьте ресторан, где каждый посетитель сам ходит на кухню, берёт ингредиенты и готовит себе еду. Это создало бы хаос на кухне и потребовало бы от каждого посетителя знаний о приготовлении блюд.
-   **В мире IT**: Необходимость организовать систему так, чтобы множество пользователей могли получать доступ к общим ресурсам и сервисам, при этом не дублируя эти ресурсы и не создавая конфликты при одновременном доступе.

**Решение:**

-   **В повседневной жизни**: Разделение на две роли: клиенты (посетители ресторана) делают заказы, а сервер (кухня ресторана) их обрабатывает и предоставляет результат. Посетителям не нужно знать, как готовится еда, а повара могут эффективно обслуживать множество клиентов.
-   **В мире IT**: Разделение системы на два компонента: клиенты (которые запрашивают сервис) и сервер (который предоставляет сервис). Сервер централизованно управляет ресурсами и обрабатывает запросы от множества клиентов.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Ресторан (посетители и кухня)
    -   Банк (клиенты и банковские работники)
    -   Библиотека (читатели и библиотекари)
    -   Магазин (покупатели и продавцы)
    -   Почтовое отделение (отправители и почтовые работники)
-   **В мире IT**:
    -   Веб-браузер и веб-сервер
    -   Почтовый клиент и почтовый сервер
    -   Мобильное приложение и backend-сервер
    -   Банкомат и банковская система
    -   Игровой клиент и игровой сервер

### Паттерн: Master-Slave (Ведущий-ведомый)

**Проблемы:**

-   **В повседневной жизни**: Представьте оркестр, где каждый музыкант играет в своём темпе и ритме. Без дирижёра это приведёт к хаосу и дисгармонии в исполнении музыкального произведения.
-   **В мире IT**: Необходимость распределить нагрузку между несколькими компонентами системы, при этом обеспечивая согласованность их работы и централизованное управление.

**Решение:**

-   **В повседневной жизни**: Назначение главного (дирижёра оркестра), который координирует действия всех остальных участников (музыкантов). Дирижёр задаёт темп, громкость и момент вступления каждой группы инструментов.
-   **В мире IT**: Выделение одного компонента системы как ведущего (master), который управляет работой нескольких ведомых компонентов (slaves). Ведущий распределяет задачи, координирует работу и собирает результаты от ведомых.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Оркестр с дирижёром
    -   Бригада строителей с прорабом
    -   Съёмочная группа с режиссёром
    -   Конвейерное производство с начальником цеха
    -   Школьный класс с учителем
-   **В мире IT**:
    -   Репликация баз данных (основная БД и её копии)
    -   Распределение вычислительных задач между процессорами
    -   Системы резервного копирования
    -   Кластеры серверов с балансировкой нагрузки
    -   Распределённые системы хранения данных

### Паттерн: Pipe-and-Filter (Конвейер и фильтры)

**Проблемы:**

-   **В повседневной жизни**: Представьте производство автомобиля, где нужно выполнить множество последовательных операций: сборка двигателя, установка колёс, покраска и т.д. Выполнять все операции в одном месте неэффективно и сложно.
-   **В мире IT**: Необходимость обработать данные через последовательность независимых операций, где каждая операция выполняет определённое преобразование данных, а результат одной операции становится входом для следующей.

**Решение:**

-   **В повседневной жизни**: Создание конвейерной линии, где каждый этап (фильтр) выполняет свою конкретную задачу, а готовый результат передаётся дальше по конвейеру (трубе) к следующему этапу.
-   **В мире IT**: Разбиение сложной задачи обработки данных на последовательность простых независимых шагов (фильтров), соединённых каналами передачи данных (трубами). Каждый фильтр получает данные, обрабатывает их и передаёт результат дальше.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Автомобильный конвейер
    -   Почтовая сортировка (сбор → сортировка → доставка)
    -   Ресторанная кухня (подготовка → готовка → оформление)
    -   Производство бумаги (измельчение → отбеливание → сушка)
    -   Обработка фотографий (проявка → промывка → сушка)
-   **В мире IT**:
    -   Обработка текстовых файлов (чтение → фильтрация → форматирование)
    -   Конвейер сборки программного обеспечения
    -   Обработка изображений (масштабирование → фильтры → сжатие)
    -   Аудио/видео обработка
    -   ETL процессы в работе с данными

## Современные архитектурные паттерны

### Паттерн: Microservices (Микросервисы)

**Проблемы:**

-   **В повседневной жизни**: Представьте большую компанию, где все отделы находятся в одном огромном помещении и все процессы взаимосвязаны. При проблеме в одном отделе страдает работа всей компании, а любые изменения требуют согласования со всеми.
-   **В мире IT**: Необходимость создать масштабируемую, гибкую систему, где изменения в одной части не влияют на работу других частей, а разные компоненты могут развиваться независимо и быть написаны на разных технологиях.

**Решение:**

-   **В повседневной жизни**: Разделение большой компании на маленькие независимые офисы, каждый со своей специализацией. Каждый офис работает автономно, имеет свои процессы и может быть модернизирован независимо от других.
-   **В мире IT**: Разбиение большого приложения на набор небольших, независимых сервисов, каждый из которых отвечает за свою конкретную функцию. Сервисы общаются между собой через сетевые протоколы и могут быть развёрнуты независимо друг от друга.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Сеть ресторанов быстрого питания
    -   Франшизы магазинов
    -   Независимые отделения банка
    -   Сеть автономных медицинских клиник
    -   Распределённые производственные цеха
-   **В мире IT**:
    -   Онлайн-магазин (сервисы каталога, корзины, оплаты, доставки)
    -   Стриминговая платформа (авторизация, контент, рекомендации)
    -   Социальная сеть (профили, сообщения, лента новостей)
    -   Банковская система (счета, переводы, кредиты)
    -   Облачная платформа (разные сервисы для разных задач)

### Паттерн: Monolith (Монолит)

**Проблемы:**

-   **В повседневной жизни**: Представьте небольшой семейный ресторан, где нужно организовать все процессы (кухня, обслуживание, склад) максимально просто и эффективно, без лишних сложностей с координацией разных подразделений.
-   **В мире IT**: Необходимость создать приложение с простой архитектурой, где все компоненты тесно связаны и должны работать как единое целое, при этом минимизируя сложность развёртывания и обслуживания.

**Решение:**

-   **В повседневной жизни**: Размещение всех функций в одном помещении, где все процессы взаимосвязаны и легко контролируются. Как в маленьком магазине, где один продавец управляет всеми аспектами работы.
-   **В мире IT**: Создание единого приложения, где все функциональные компоненты (пользовательский интерфейс, бизнес-логика, доступ к данным) объединены в один исполняемый файл или проект. Все части приложения используют общие ресурсы и развёртываются вместе.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Маленький семейный магазин
    -   Небольшой ресторан
    -   Частная клиника с одним врачом
    -   Мастерская одного мастера
    -   Маленькая юридическая фирма
-   **В мире IT**:
    -   Корпоративные CRM системы
    -   Блоги и простые веб-сайты
    -   Административные панели
    -   Мобильные приложения
    -   Внутренние инструменты компании

### Паттерн: Event-Driven Architecture (Событийная архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте большой торговый центр, где нужно координировать работу множества магазинов, охраны, клининга и других служб. Каждая служба должна реагировать на различные события (открытие/закрытие, чрезвычайные ситуации, уборка) независимо от других.
-   **В мире IT**: Необходимость создать систему, где компоненты могут реагировать на изменения состояния или действия пользователей асинхронно, не блокируя друг друга и не требуя прямой связи между собой.

**Решение:**

-   **В повседневной жизни**: Создание системы оповещений, где каждое событие (например, объявление по громкой связи) информирует все заинтересованные службы, которые затем самостоятельно решают, как на него реагировать.
-   **В мире IT**: Построение системы, основанной на создании, обнаружении, потреблении и реакции на события. Компоненты системы общаются путём отправки и получения событий через общую шину событий.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Система оповещения в торговом центре
    -   Организация спортивных мероприятий
    -   Управление аэропортом
    -   Система экстренного реагирования
    -   Координация работы ресторана
-   **В мире IT**:
    -   Системы мониторинга и логирования
    -   Платформы для обработки заказов
    -   Социальные сети (реакция на действия пользователей)
    -   IoT системы (реакция на показания датчиков)
    -   Биржевые торговые платформы

### Паттерн: Service-Oriented Architecture (SOA, Сервис-ориентированная архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте крупную корпорацию с множеством отделов, где каждый отдел предоставляет определённые услуги другим отделам. Без чёткой организации взаимодействия между отделами возникает путаница и дублирование функций.
-   **В мире IT**: Необходимость организовать крупную корпоративную систему так, чтобы различные её компоненты могли быть повторно использованы, легко интегрировались друг с другом и с внешними системами, при этом оставаясь независимыми.

**Решение:**

-   **В повседневной жизни**: Организация работы по принципу предоставления услуг, где каждый отдел чётко определяет свои сервисы и условия их использования. Как в большом отеле, где есть служба уборки, ресторан, спа-салон и каждая служба предоставляет свои услуги независимо.
-   **В мире IT**: Разделение функциональности на набор независимых, стандартизированных сервисов, которые могут быть использованы различными частями приложения через стандартные протоколы и интерфейсы.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Организация работы крупного отеля
    -   Система городских муниципальных служб
    -   Сеть медицинских учреждений
    -   Система банковских услуг
    -   Организация работы университета
-   **В мире IT**:
    -   Корпоративные информационные системы
    -   Интеграция унаследованных систем
    -   Банковские платформы
    -   Системы электронного правительства
    -   Телекоммуникационные платформы

### Паттерн: Serverless (Бессерверная архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте, что вы хотите организовать мероприятие, но не хотите заниматься арендой помещения, его обслуживанием и всей инфраструктурой. Вы хотите сосредоточиться только на самом мероприятии.
-   **В мире IT**: Необходимость разрабатывать и запускать приложения без заботы об инфраструктуре, серверах, их масштабировании и обслуживании, концентрируясь только на бизнес-логике.

**Решение:**

-   **В повседневной жизни**: Использование коворкингов или событийных пространств, где вся инфраструктура предоставляется как услуга. Вы платите только за фактическое время использования и получаете всё необходимое обслуживание.
-   **В мире IT**: Использование облачных сервисов, которые автоматически управляют всей инфраструктурой. Разработчики просто пишут код функций, а провайдер заботится о его выполнении, масштабировании и доступности.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Организация мероприятий в коворкингах
    -   Использование каршеринга вместо покупки автомобиля
    -   Аренда оборудования по требованию
    -   Заказ еды через службу доставки
    -   Использование облачного хранилища вместо покупки жёсткого диска
-   **В мире IT**:
    -   Обработка изображений по запросу
    -   Периодические задачи по расписанию
    -   Чат-боты и виртуальные помощники
    -   API для мобильных приложений
    -   Обработка данных в реальном времени

## Шаблоны организации кода и зависимостей

### Паттерн: Hexagonal Architecture (Гексагональная архитектура, Ports & Adapters)

**Проблемы:**

-   **В повседневной жизни**: Представьте универсальный пульт управления, который должен работать с разными устройствами (телевизор, кондиционер, музыкальный центр). Каждое устройство имеет свой протокол управления, но пользователь хочет единый интерфейс.
-   **В мире IT**: Необходимость создать приложение, которое может легко взаимодействовать с разными внешними системами (базы данных, UI, API), при этом сохраняя свою бизнес-логику независимой от конкретных технологий.

**Решение:**

-   **В повседневной жизни**: Создание универсального устройства с набором стандартных портов, к которым через специальные адаптеры можно подключить любое оборудование. Как современный ноутбук с USB-портами и различными переходниками.
-   **В мире IT**: Организация приложения в виде шестиугольника, где бизнес-логика находится в центре, а взаимодействие с внешним миром происходит через порты (интерфейсы) и адаптеры, которые преобразуют внешние протоколы в понятный для ядра формат.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Универсальные зарядные устройства
    -   Системы "умный дом" с разными устройствами
    -   Платёжные терминалы с разными способами оплаты
    -   Пульты управления бытовой техникой
    -   Универсальные медиацентры
-   **В мире IT**:
    -   Системы с множеством интерфейсов (веб, мобильный, API)
    -   Приложения с поддержкой разных баз данных
    -   Платёжные системы с разными провайдерами
    -   Системы с множеством источников данных
    -   Приложения с поддержкой разных протоколов связи

### Паттерн: Onion Architecture (Луковичная архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте организацию секретного объекта, где нужно обеспечить разные уровни доступа: от внешнего периметра до самого защищённого центра. Каждый следующий уровень должен быть доступен только через предыдущий.
-   **В мире IT**: Необходимость организовать код так, чтобы наиболее важные части (бизнес-логика) были максимально защищены от внешних изменений и зависимостей, а внешние слои могли меняться без влияния на внутренние.

**Решение:**

-   **В повседневной жизни**: Организация системы безопасности по принципу луковицы, где каждый слой защищает внутренний, а доступ к центру возможен только через последовательное прохождение всех внешних слоёв.
-   **В мире IT**: Структурирование приложения в виде концентрических кругов (слоёв), где в центре находится доменная модель, а каждый внешний слой зависит только от внутренних слоёв. Внешние слои могут быть заменены без влияния на внутренние.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Система безопасности в банке
    -   Организация военных объектов
    -   Структура правительственных учреждений
    -   Система контроля доступа в офисных зданиях
    -   Организация архивов с разными уровнями доступа
-   **В мире IT**:
    -   Корпоративные бизнес-приложения
    -   Финансовые системы
    -   Системы управления предприятием
    -   Медицинские информационные системы
    -   Системы с сложной бизнес-логикой

### Паттерн: Clean Architecture (Чистая архитектура)

**Проблемы:**

-   **В повседневной жизни**: Представьте строительство дома, где нужно обеспечить независимость основной конструкции от деталей отделки, мебели и коммуникаций. Хочется иметь возможность менять интерьер и коммуникации, не затрагивая несущие стены.
-   **В мире IT**: Необходимость создать систему, которая была бы независима от внешних факторов (фреймворки, базы данных, UI), легко тестируема и могла развиваться без существенных изменений в основной логике.

**Решение:**

-   **В повседневной жизни**: Разделение всех элементов дома на независимые слои: фундамент и несущие конструкции (не зависят ни от чего), коммуникации (зависят от конструкции), отделка и мебель (зависят от всего остального). Изменения в верхних слоях не влияют на нижние.
-   **В мире IT**: Организация кода в концентрические круги, где внутренние круги содержат бизнес-логику и не знают ничего о внешних кругах. Все зависимости направлены внутрь, к центру архитектуры.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Модульное строительство домов
    -   Организация производственных линий
    -   Проектирование автомобилей
    -   Создание модульной мебели
    -   Разработка бытовой техники
-   **В мире IT**:
    -   Корпоративные веб-приложения
    -   Мобильные приложения
    -   Системы автоматизации
    -   Игровые движки
    -   Микросервисные архитектуры

## Паттерны для работы с данными и коммуникациями

### Паттерн: CQRS (Command Query Responsibility Segregation)

**Проблемы:**

-   **В повседневной жизни**: Представьте библиотеку, где процесс выдачи книг (изменение состояния) и поиск информации о книгах (чтение) требуют разных подходов и разной организации. Смешивание этих процессов создаёт очереди и путаницу.
-   **В мире IT**: Необходимость оптимизировать систему, где операции чтения и записи данных имеют разные требования к производительности, масштабируемости и согласованности данных.

**Решение:**

-   **В повседневной жизни**: Разделение библиотеки на два отдела: один занимается только выдачей и возвратом книг, другой - только предоставлением информации о книгах. Каждый отдел оптимизирован под свои задачи.
-   **В мире IT**: Разделение приложения на две части: одна обрабатывает команды (изменение данных), другая обрабатывает запросы (чтение данных). Каждая часть может быть оптимизирована независимо и использовать разные модели данных.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Организация работы библиотеки
    -   Банковские операции (транзакции и выписки)
    -   Работа магазина (продажи и инвентаризация)
    -   Почтовая служба (отправка и отслеживание)
    -   Ресторан (приём заказов и информация о меню)
-   **В мире IT**:
    -   Высоконагруженные веб-приложения
    -   Системы отчётности
    -   Торговые платформы
    -   Системы бронирования
    -   Социальные сети

### Паттерн: Event Sourcing (Событийное хранение)

**Проблемы:**

-   **В повседневной жизни**: Представьте бухгалтерскую книгу, где нужно не только знать текущий баланс, но и иметь возможность проследить историю всех операций, восстановить состояние на любой момент времени и проверить правильность текущего состояния.
-   **В мире IT**: Необходимость хранить не только текущее состояние системы, но и полную историю изменений, с возможностью восстановления состояния на любой момент времени и аудита всех действий.

**Решение:**

-   **В повседневной жизни**: Вместо обновления конечного состояния, ведение журнала всех событий (транзакций), где каждое новое событие добавляется в конец. Текущее состояние всегда можно получить, "проиграв" все события с начала.
-   **В мире IT**: Хранение всех изменений состояния системы в виде последовательности событий. Текущее состояние формируется путём последовательной обработки всех событий, а не путём перезаписи данных.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Бухгалтерский учёт
    -   Медицинские карты пациентов
    -   История банковских операций
    -   Журнал изменений в документах
    -   Протокол судебных заседаний
-   **В мире IT**:
    -   Банковские системы
    -   Системы аудита
    -   Системы контроля версий
    -   Логирование действий пользователей
    -   Отслеживание состояния заказов

### Паттерн: Repository (Репозиторий)

**Проблемы:**

-   **В повседневной жизни**: Представьте большой склад с множеством товаров, где нужно организовать единый способ доступа к товарам, независимо от их расположения (на полках, в контейнерах, в разных помещениях) и способа хранения.
-   **В мире IT**: Необходимость обеспечить единый интерфейс для доступа к данным, скрыв детали их хранения и извлечения, а также упростить тестирование и замену способа хранения данных.

**Решение:**

-   **В повседневной жизни**: Создание единой системы управления складом, где все запросы на получение или размещение товаров обрабатываются централизованно, а сотрудникам не нужно знать особенности организации хранения.
-   **В мире IT**: Создание промежуточного слоя (репозитория) между бизнес-логикой и хранилищем данных, который предоставляет простой интерфейс для работы с данными и скрывает детали их хранения.

**Примеры применения:**

-   **В повседневной жизни**:
    -   Библиотечный каталог
    -   Складская система
    -   Архив документов
    -   Картотека в больнице
    -   Музейное хранилище
-   **В мире IT**:
    -   Доступ к базе данных
    -   Кэширование данных
    -   Работа с файловой системой
    -   Доступ к внешним API
    -   Управление состоянием приложения
